# Results

```{r}
library(dplyr)
library(tidyr)
library(grid)
library(ggplot2)
library(GGally)
library(ggalluvial)
```

**Percentage of interviewees with Anxiety Over 4 years, by gender**
```{r}
options(dplyr.summarise.inform = FALSE)
nhisBar <- NHIS_final %>%
  filter(History_of_Anxiety !='Missing') %>%
  filter(Sex=="Male" | Sex=="Female")
nhisBar1 <- nhisBar %>%
  group_by(Year, History_of_Anxiety, Sex) %>%
  dplyr::summarise(Freq = n())
ggplot(nhisBar1, aes(x = Year, y=Freq, fill = History_of_Anxiety)) + 
    geom_bar(position="fill", stat="identity") +
  facet_wrap(~Sex) +
  scale_fill_manual(values = c("#E7BCC6", "#768CCe", "#B4BBC0", "#FAE367")) +
  theme_minimal()
```

Although the population interviewed each year was not a fixed group of people, we have no way of knowing whether the same group of people had a change in their mental health during those years. However, according to the graph above, the percentage of interviewees with anxiety disorders has increased yearly—both the percentage of males and females. On the male side, we can see that the increase is relatively small, but there is no sign of a decrease. The increase from 2018 to 2019 is more significant on the female side. The increase is almost 50% of those with anxiety disorders in 2018. The increase continues each year slowly after that. 
We can also note that the proportion of women with anxiety disorders is greater than that of men, with almost 25% of women having anxiety disorders by 2021. 

**Anxiety vs. Physical Diseases**
```{r}
orderedclasses <- c("Yes", "No", "Refused", "Do not Know", "Missing")
mydata <- NHIS_final %>%
  select("History_of_Anxiety","History_of_Heart_disease")
mydata$History_of_Anxiety <- factor(mydata$History_of_Anxiety, levels = orderedclasses)
mydata$History_of_Heart_disease <- factor(mydata$History_of_Heart_disease, levels = orderedclasses)
mydata1 <- mydata %>%
  group_by(History_of_Anxiety, History_of_Heart_disease) %>%
  dplyr::summarise(Freq=n()) 
mydata1 <- mydata1 %>% group_by(History_of_Anxiety) %>% 
  mutate(Total = sum(Freq)) %>% ungroup()

mydata2 <- NHIS_final %>%
  select("History_of_Anxiety","History_of_Cancer")
mydata2$History_of_Anxiety <- factor(mydata2$History_of_Anxiety, levels = orderedclasses)
mydata2$History_of_Cancer <- factor(mydata2$History_of_Cancer, levels = orderedclasses)
mydata3 <- mydata2 %>%
  group_by(History_of_Anxiety, History_of_Cancer) %>%
  dplyr::summarise(Freq=n()) 
mydata3 <- mydata3 %>% group_by(History_of_Anxiety) %>% 
  mutate(Total = sum(Freq)) %>% ungroup()

mydata4 <- NHIS_final %>%
  select("History_of_Anxiety","History_of_Stroke")
mydata4$History_of_Anxiety <- factor(mydata4$History_of_Anxiety, levels = orderedclasses)
mydata4$History_of_Stroke <- factor(mydata4$History_of_Stroke, levels = orderedclasses)
mydata5 <- mydata4 %>%
  group_by(History_of_Anxiety, History_of_Stroke) %>%
  dplyr::summarise(Freq=n()) 
mydata5 <- mydata5 %>% group_by(History_of_Anxiety) %>% 
  mutate(Total = sum(Freq)) %>% ungroup()
```

```{r}
mydata6 <- NHIS_final %>%
  select("History_of_Anxiety","History_of_Diabetes")
mydata6$History_of_Anxiety <- factor(mydata6$History_of_Anxiety, levels = orderedclasses)
mydata6$History_of_Diabetes <- factor(mydata6$History_of_Diabetes, levels = orderedclasses)
mydata7 <- mydata6%>%
  group_by(History_of_Anxiety, History_of_Diabetes) %>%
  dplyr::summarise(Freq=n()) 
mydata7 <- mydata7 %>% group_by(History_of_Anxiety) %>% 
  mutate(Total = sum(Freq)) %>% ungroup()
```

```{r}
mydata8 <- NHIS_final %>%
  select("History_of_Anxiety","History_of_Asthma")
mydata8$History_of_Anxiety <- factor(mydata8$History_of_Anxiety, levels = orderedclasses)
mydata8$History_of_Asthma <- factor(mydata8$History_of_Asthma, levels = orderedclasses)
mydata9 <- mydata8%>%
  group_by(History_of_Anxiety, History_of_Asthma) %>%
  dplyr::summarise(Freq=n()) 
mydata9 <- mydata9 %>% group_by(History_of_Anxiety) %>% 
  mutate(Total = sum(Freq)) %>% ungroup()
```


```{r fig.width=9, fig.height=8}
h1 <- ggplot(subset(subset(mydata1, !is.na(History_of_Heart_disease)), !is.na(History_of_Anxiety)), aes(x = History_of_Anxiety, y = History_of_Heart_disease)) +
  geom_tile(aes(fill = (Freq/Total)), color = "white") +
  coord_fixed() + 
  scale_fill_gradientn(colors=c("#ffe5b5", "#feb538", "#c85103")) +
  theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1))+
  labs(fill = "Freq in Anxiety")

h2 <- ggplot(subset(subset(mydata3, !is.na(History_of_Cancer)), !is.na(History_of_Anxiety)), aes(x = History_of_Anxiety, y = History_of_Cancer)) +
  geom_tile(aes(fill = (Freq/Total)), color = "white") +
  coord_fixed() + 
  scale_fill_gradientn(colors=c("#ffe5b5", "#feb538", "#c85103"))+
  theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1))+
  labs(fill = "Freq in Anxiety")

h3 <- ggplot(subset(subset(mydata5, !is.na(History_of_Stroke)), !is.na(History_of_Anxiety)), aes(x = History_of_Anxiety, y = History_of_Stroke)) +
  geom_tile(aes(fill = (Freq/Total)), color = "white") +
  coord_fixed() + 
  scale_fill_gradientn(colors=c("#ffe5b5", "#feb538", "#c85103"))+
  theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1))+
  labs(fill = "Freq in Anxiety")

h4 <- ggplot(subset(subset(mydata7, !is.na(History_of_Diabetes)), !is.na(History_of_Anxiety)), aes(x = History_of_Anxiety, y = History_of_Diabetes)) +
  geom_tile(aes(fill = (Freq/Total)), color = "white") +
  coord_fixed() + 
  scale_fill_gradientn(colors=c("#ffe5b5", "#feb538", "#c85103"))+
  theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1))+
  labs(fill = "Freq in Anxiety")

h5 <- ggplot(subset(subset(mydata9, !is.na(History_of_Asthma)), !is.na(History_of_Anxiety)), aes(x = History_of_Anxiety, y = History_of_Asthma)) +
  geom_tile(aes(fill = Freq/Total), color = "white") +
  coord_fixed() + 
  scale_fill_gradientn(colors=c("#ffe5b5", "#feb538", "#c85103"))+
  theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1)) +
  labs(fill = "Freq in Anxiety")
gridExtra::grid.arrange(h1, h2, h3, h4,h5)
```

In the above five plots, the x-axis represents the interviewee population's different responses to the history of Anxiety. The y-axis corresponds to the responses for other physical diseases. For each response to Anxiety, we tried to find the proportion of responses for other diseases. For example, the first graph contains variables of history of Anxiety and history of heart disease.
Among those who had Anxiety, more than 75% chose no, which means more than 75% of people do not have heart disease.
After comparing Anxiety with other diseases, we can see that the percentage of people who answered yes to both asthma and a history of Anxiety is the highest among the five diseases. We can probably assume that there is a relationship between them. 

```{r}
nhisAnxiety <- NHIS_final %>%
  select(History_of_Anxiety, Year)
anxiety<-as.data.frame(table(NHIS_final$History_of_Anxiety))


nhisHeart <- NHIS_final %>%
  select(History_of_Heart_disease)
heart<-as.data.frame(table(NHIS_final$History_of_Heart_disease))

nhisCancer <- NHIS_final %>%
  select(History_of_Cancer)
cancer<-as.data.frame(table(NHIS_final$History_of_Cancer))

nhisStroke <- NHIS_final %>%
  select(History_of_Stroke)
stroke<-as.data.frame(table(NHIS_final$History_of_Stroke))

nhisDiabetes <- NHIS_final %>%
  select(History_of_Diabetes)
diabetes<-as.data.frame(table(NHIS_final$History_of_Diabetes))

nhisAsthma <- NHIS_final %>%
  select(History_of_Asthma)
asthma<-as.data.frame(table(NHIS_final$History_of_Asthma))
```

```{r}
heat1 <- inner_join(x=anxiety, y=heart, by="Var1")
heat2 <- inner_join(x=heat1, y=cancer, by="Var1")
heat3 <- inner_join(x=heat2, y=stroke, by="Var1")
heat4 <- inner_join(x=heat3, y=diabetes, by="Var1")
heat5 <- inner_join(x=heat4, y=asthma, by="Var1")
colnames(heat5)[1:7] =c("Answer", "Anxiety","Heart_disease", "Cancer", "Stroke", "Diabetes", "Asthma")
draw_biplot(heat5)
```

When two vectors are close, forming a small angle, the two variables they represent are positively correlated.
If they meet each other at 90°, they are not likely to be correlated.



```{r}

nhisCleve <- NHIS_final %>%
  filter(History_of_Anxiety !='Missing') 
nhisCleve$History_of_Anxiety <- factor(nhisCleve$History_of_Anxiety)
nhisCleve1 <- nhisCleve %>%
  group_by(Age, History_of_Anxiety) %>%
  dplyr::summarise(freq=n()) 
nhisCleve2 <- nhisCleve1%>%
  mutate(Total = sum(freq))
nhisCleve3 <- nhisCleve2%>%
  mutate(pro = freq/Total)
ggplot(nhisCleve3, aes(x = pro, y = Age)) +
 geom_point(aes(color = History_of_Anxiety))+
  theme_linedraw()

```


```{r}
nhisBar2 <- NHIS_final %>%
  filter(History_of_Anxiety !='Missing') %>%
  filter(Smoking !='Missing' & Smoking != 'Do not know' & Smoking!='Refused') 
nhisBar3 <- nhisBar2 %>%
  group_by(History_of_Anxiety,Smoking) %>%
  dplyr::summarise(Freq = n())
ggplot(nhisBar3, aes(x = Smoking, y=Freq, fill = History_of_Anxiety)) + 
    geom_bar(position="fill", stat="identity") +
  scale_fill_manual(values = c("#E7BCC6", "#768CCe", "#B4BBC0", "#FAE367"))+
  theme_minimal()
```




